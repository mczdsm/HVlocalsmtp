FROM dperson/samba:latest

# Install ACL utilities
RUN apk add --no-cache acl

# Copy the custom entrypoint and permission script
COPY samba-entrypoint.sh /usr/local/bin/
COPY init-permissions.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/samba-entrypoint.sh /usr/local/bin/init-permissions.sh

# Set the custom entrypoint
ENTRYPOINT ["/usr/local/bin/samba-entrypoint.sh"]